<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>kdumpå¤±è´¥é—®é¢˜æ’æŸ¥ | YZWDDSG</title>
  <meta name="keywords" content="">
  <meta name="description" content="kdumpå¤±è´¥é—®é¢˜æ’æŸ¥ | YZWDDSG">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="google-site-verification" content="xxJB9SNPOytyUXCA2HZ6ZgNbI5iEx6C2GX3XuMKlBv0" />
<meta property="og:type" content="website">
<meta property="og:title" content="categories">
<meta property="og:url" content="http://example.com/categories/index.html">
<meta property="og:site_name" content="YZWDDSG">
<meta property="og:locale">
<meta property="article:published_time" content="2025-02-23T15:43:05.000Z">
<meta property="article:modified_time" content="2025-02-23T15:43:53.864Z">
<meta property="article:author" content="YZWDDSG">
<meta name="twitter:card" content="summary">


<link rel="icon" href="/img/avatar.jpg">

<link href="/css/style.css?v=1.1.0" rel="stylesheet">

<link href="/css/hl_theme/atom-dark.css?v=1.1.0" rel="stylesheet">

<link href="//cdn.jsdelivr.net/npm/animate.css@4.1.0/animate.min.css" rel="stylesheet">

<script src="//cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js"></script>
<script src="/js/titleTip.js?v=1.1.0" ></script>

<script src="//cdn.jsdelivr.net/npm/highlightjs@9.16.2/highlight.pack.min.js"></script>
<script>
    hljs.initHighlightingOnLoad();
</script>

<script src="//cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.js"></script>



<script src="//cdn.jsdelivr.net/npm/jquery.cookie@1.4.1/jquery.cookie.min.js" ></script>

<script src="/js/iconfont.js?v=1.1.0" ></script>
<script src="/js/custom-iconfont.js?v=1.1.0" ></script>


<meta name="generator" content="Hexo 7.3.0"></head>
<div style="display: none">
  <input class="theme_disqus_on" value="false">
  <input class="theme_preload_comment" value="">
  <input class="theme_blog_path" value="">
  <input id="theme_shortcut" value="true" />
  <input id="theme_highlight_on" value="true" />
  <input id="theme_code_copy" value="true" />
</div>



<body>
<aside class="nav">
    <div class="nav-left">
        <a href="/"
   class="avatar_target">
    <img class="avatar"
         src="/img/avatar.jpg"/>
</a>
<div class="author">
    <span>YZWDDSG</span>
</div>

<div class="icon">
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
</div>





<ul>
    <li>
        <div class="all active" data-rel="å…¨éƒ¨æ–‡ç« ">å…¨éƒ¨æ–‡ç« 
            
                <small>(35)</small>
            
        </div>
    </li>
    
        
            
                
    <li>
        <div data-rel="ç¡¬ä»¶">
            
            ç¡¬ä»¶
            <small>(4)</small>
        </div>
        
    </li>

            
        
    
        
            
                
    <li>
        <div data-rel="è°ƒåº¦">
            
            è°ƒåº¦
            <small>(2)</small>
        </div>
        
    </li>

            
        
    
        
            
                
    <li>
        <div data-rel="å†…å­˜">
            
            å†…å­˜
            <small>(1)</small>
        </div>
        
    </li>

            
        
    
        
            
                
    <li>
        <div data-rel="å­˜å‚¨">
            
            å­˜å‚¨
            <small>(1)</small>
        </div>
        
    </li>

            
        
    
        
            
                
    <li>
        <div data-rel="ç½‘ç»œ">
            
            ç½‘ç»œ
            <small>(1)</small>
        </div>
        
    </li>

            
        
    
        
            
                
    <li>
        <div data-rel="æ–‡ä»¶ç³»ç»Ÿ">
            
            æ–‡ä»¶ç³»ç»Ÿ
            <small>(1)</small>
        </div>
        
    </li>

            
        
    
        
            
                
    <li>
        <div data-rel="è™šæ‹ŸåŒ–">
            
            è™šæ‹ŸåŒ–
            <small>(1)</small>
        </div>
        
    </li>

            
        
    
        
            
                
    <li>
        <div data-rel="power">
            
            power
            <small>(1)</small>
        </div>
        
    </li>

            
        
    
        
            
                
    <li>
        <div data-rel="OS">
            
            OS
            <small>(3)</small>
        </div>
        
    </li>

            
        
    
        
            
                
    <li>
        <div data-rel="æ•…éšœæ’æŸ¥">
            
            æ•…éšœæ’æŸ¥
            <small>(11)</small>
        </div>
        
    </li>

            
        
    
        
            
                
    <li>
        <div data-rel="å…¶ä»–">
            
            å…¶ä»–
            <small>(6)</small>
        </div>
        
    </li>

            
        
    
        
            
                
    <li>
        <div data-rel="ä¸ªäºº">
            
            ä¸ªäºº
            <small>(3)</small>
        </div>
        
    </li>

            
        
    
</ul>
<div class="left-bottom">
    <div class="menus">
        
            
            
            
    </div>
    <div>
        
            <a class="about  site_url"
               
               href="/about">å…³äº</a>
        
        
    </div>
</div>
<input type="hidden" id="yelog_site_posts_number" value="35">
<input type="hidden" id="yelog_site_word_count" value="83.5k">
<div style="display: none">
    <span id="busuanzi_value_site_uv"></span>
    <span id="busuanzi_value_site_pv"></span>
</div>

    </div>
    <div class="nav-right">
        <div class="friends-area">
    <div class="friends-title">
        å‹æƒ…é“¾æ¥
        <i class="iconfont icon-left"></i>
    </div>
    <div class="friends-content">
        <ul>
            
            <li><a target="_blank" href="http://yelog.org/">å¶è½é˜</a></li>
            
        </ul>
    </div>
</div>
        <div class="title-list">
    <div class="right-top">
        <div id="default-panel">
            <i class="iconfont icon-search" data-title="æœç´¢ å¿«æ·é”® i"></i>
            <div class="right-title">å…¨éƒ¨æ–‡ç« </div>
            <i class="iconfont icon-file-tree" data-title="åˆ‡æ¢åˆ°å¤§çº²è§†å›¾ å¿«æ·é”® w"></i>
        </div>
        <div id="search-panel">
            <i class="iconfont icon-left" data-title="è¿”å›"></i>
            <input id="local-search-input" autocomplete="off"/>
            <label class="border-line" for="input"></label>
            <i class="iconfont icon-case-sensitive" data-title="å¤§å°å†™æ•æ„Ÿ"></i>
            <i class="iconfont icon-tag" data-title="æ ‡ç­¾"></i>
        </div>
        <div id="outline-panel" style="display: none">
            <div class="right-title">å¤§çº²</div>
            <i class="iconfont icon-list" data-title="åˆ‡æ¢åˆ°æ–‡ç« åˆ—è¡¨"></i>
        </div>
    </div>

    <div class="tags-list">
    <input id="tag-search" />
    <div class="tag-wrapper">
        
    </div>

</div>

    
    <nav id="title-list-nav">
        
        
        <a  class="å…¨éƒ¨æ–‡ç«  å…¶ä»– "
           href="/2026/02/13/%E6%96%B0%E5%B9%B4%E8%B4%BA%E5%B2%81%E7%89%87%E4%B9%8Blinux%E4%B8%AD%E7%9A%84signal/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="æ–°å¹´è´ºå²ç‰‡ä¹‹linuxä¸­çš„signal">æ–°å¹´è´ºå²ç‰‡ä¹‹linuxä¸­çš„signal</span>
            <span class="post-date" title="2026-02-13 21:21:34">2026/02/13</span>
        </a>
        
        
        <a  class="å…¨éƒ¨æ–‡ç«  æ•…éšœæ’æŸ¥ "
           href="/2026/01/30/%E7%BD%91%E5%8D%A1%E9%A9%B1%E5%8A%A8probe%E5%A4%B1%E8%B4%A5/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="ç½‘å¡é©±åŠ¨probeå¤±è´¥">ç½‘å¡é©±åŠ¨probeå¤±è´¥</span>
            <span class="post-date" title="2026-01-30 20:50:05">2026/01/30</span>
        </a>
        
        
        <a  class="å…¨éƒ¨æ–‡ç«  æ•…éšœæ’æŸ¥ "
           href="/2025/11/18/fsnotify%E5%AF%BC%E8%87%B4%E7%9A%84softlockup/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="fsnotifyå¯¼è‡´çš„softlockup">fsnotifyå¯¼è‡´çš„softlockup</span>
            <span class="post-date" title="2025-11-18 23:53:46">2025/11/18</span>
        </a>
        
        
        <a  class="å…¨éƒ¨æ–‡ç«  å…¶ä»– "
           href="/2025/11/02/%E5%86%85%E6%A0%B8%E4%B8%AD%E7%9A%84guard%E5%AE%8F/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="å†…æ ¸ä¸­çš„guardå®">å†…æ ¸ä¸­çš„guardå®</span>
            <span class="post-date" title="2025-11-02 22:49:38">2025/11/02</span>
        </a>
        
        
        <a  class="å…¨éƒ¨æ–‡ç«  æ•…éšœæ’æŸ¥ "
           href="/2025/10/26/CPU%E6%8A%96%E5%8A%A8%E5%8E%9F%E5%9B%A0/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="CPUæŠ–åŠ¨åŸå› ">CPUæŠ–åŠ¨åŸå› </span>
            <span class="post-date" title="2025-10-26 23:34:25">2025/10/26</span>
        </a>
        
        
        <a  class="å…¨éƒ¨æ–‡ç«  å…¶ä»– "
           href="/2025/10/19/%E6%9F%A5%E7%9C%8Binitramfs/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="æŸ¥çœ‹initramfs">æŸ¥çœ‹initramfs</span>
            <span class="post-date" title="2025-10-19 23:28:27">2025/10/19</span>
        </a>
        
        
        <a  class="å…¨éƒ¨æ–‡ç«  å…¶ä»– "
           href="/2025/08/18/%E4%B8%80%E4%B8%AAFPU%E7%9B%B8%E5%85%B3%E9%97%AE%E9%A2%98%E7%9A%84%E4%BF%AE%E5%A4%8D-without-kdump/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="ä¸€ä¸ªFPUç›¸å…³é—®é¢˜çš„ä¿®å¤---without kdump">ä¸€ä¸ªFPUç›¸å…³é—®é¢˜çš„ä¿®å¤---without kdump</span>
            <span class="post-date" title="2025-08-18 21:53:35">2025/08/18</span>
        </a>
        
        
        <a  class="å…¨éƒ¨æ–‡ç«  æ•…éšœæ’æŸ¥ "
           href="/2025/07/04/kdump%E5%A4%B1%E8%B4%A5%E9%97%AE%E9%A2%98%E6%8E%92%E6%9F%A5/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="kdumpå¤±è´¥é—®é¢˜æ’æŸ¥">kdumpå¤±è´¥é—®é¢˜æ’æŸ¥</span>
            <span class="post-date" title="2025-07-04 23:03:39">2025/07/04</span>
        </a>
        
        
        <a  class="å…¨éƒ¨æ–‡ç«  ä¸ªäºº "
           href="/2025/06/13/%E8%AE%B0%E4%B8%80%E5%8F%AA%E6%B5%81%E6%B5%AA%E6%96%91%E7%82%B9%E7%8B%97/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="è®°ä¸€åªæµæµªæ–‘ç‚¹ç‹—">è®°ä¸€åªæµæµªæ–‘ç‚¹ç‹—</span>
            <span class="post-date" title="2025-06-13 21:39:16">2025/06/13</span>
        </a>
        
        
        <a  class="å…¨éƒ¨æ–‡ç«  ç¡¬ä»¶ "
           href="/2025/05/28/AMD-ERAPS/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="AMD ERAPS">AMD ERAPS</span>
            <span class="post-date" title="2025-05-28 21:52:56">2025/05/28</span>
        </a>
        
        
        <a  class="å…¨éƒ¨æ–‡ç«  å…¶ä»– "
           href="/2025/04/26/popen%E5%AF%BC%E8%87%B4%E7%9A%84%E9%97%AE%E9%A2%98%E5%8F%8A%E5%88%86%E6%9E%90/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="popenå¯¼è‡´çš„é—®é¢˜åŠåˆ†æ">popenå¯¼è‡´çš„é—®é¢˜åŠåˆ†æ</span>
            <span class="post-date" title="2025-04-26 23:15:08">2025/04/26</span>
        </a>
        
        
        <a  class="å…¨éƒ¨æ–‡ç«  å­˜å‚¨ "
           href="/2025/04/20/nbd%E9%A9%B1%E5%8A%A8%E7%9A%84%E5%AE%9E%E7%8E%B0/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="nbdé©±åŠ¨çš„å®ç°">nbdé©±åŠ¨çš„å®ç°</span>
            <span class="post-date" title="2025-04-20 16:41:42">2025/04/20</span>
        </a>
        
        
        <a  class="å…¨éƒ¨æ–‡ç«  å†…å­˜ "
           href="/2025/04/11/%E5%A6%82%E4%BD%95%E7%90%86%E8%A7%A3meminfo%E4%B8%AD%E7%9A%84MemAvailable%E5%92%8CMemFree/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="å¦‚ä½•ç†è§£meminfoä¸­çš„MemAvailableå’ŒMemFree">å¦‚ä½•ç†è§£meminfoä¸­çš„MemAvailableå’ŒMemFree</span>
            <span class="post-date" title="2025-04-11 19:43:19">2025/04/11</span>
        </a>
        
        
        <a  class="å…¨éƒ¨æ–‡ç«  æ•…éšœæ’æŸ¥ "
           href="/2025/04/09/%E6%89%A7%E8%A1%8Crpm%E5%91%BD%E4%BB%A4%E5%8D%A1%E6%AD%BB%E6%8E%92%E6%9F%A5/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="æ‰§è¡Œrpmå‘½ä»¤å¡æ­»æ’æŸ¥">æ‰§è¡Œrpmå‘½ä»¤å¡æ­»æ’æŸ¥</span>
            <span class="post-date" title="2025-04-09 22:11:15">2025/04/09</span>
        </a>
        
        
        <a  class="å…¨éƒ¨æ–‡ç«  è°ƒåº¦ "
           href="/2025/04/07/CPU%E5%88%A9%E7%94%A8%E7%8E%87%E4%B8%8D%E5%9D%87%E8%A1%A1%E9%97%AE%E9%A2%98-sched-domain%E5%AD%A6%E4%B9%A0/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="CPUåˆ©ç”¨ç‡ä¸å‡è¡¡é—®é¢˜-sched_domainå­¦ä¹ ">CPUåˆ©ç”¨ç‡ä¸å‡è¡¡é—®é¢˜-sched_domainå­¦ä¹ </span>
            <span class="post-date" title="2025-04-07 22:04:47">2025/04/07</span>
        </a>
        
        
        <a  class="å…¨éƒ¨æ–‡ç«  ç¡¬ä»¶ "
           href="/2025/04/05/PCIE%E8%AE%BE%E5%A4%87%E7%83%AD%E6%8F%92%E6%8B%94/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="PCIEè®¾å¤‡çƒ­æ’æ‹”">PCIEè®¾å¤‡çƒ­æ’æ‹”</span>
            <span class="post-date" title="2025-04-05 22:00:12">2025/04/05</span>
        </a>
        
        
        <a  class="å…¨éƒ¨æ–‡ç«  ä¸ªäºº "
           href="/2025/04/03/%E6%88%91%E5%92%8C%E6%88%91%E7%9A%84%E7%8B%97%E5%AD%90%E4%BB%AC/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="æˆ‘å’Œæˆ‘çš„ç‹—å­ä»¬">æˆ‘å’Œæˆ‘çš„ç‹—å­ä»¬</span>
            <span class="post-date" title="2025-04-03 22:18:32">2025/04/03</span>
        </a>
        
        
        <a  class="å…¨éƒ¨æ–‡ç«  è°ƒåº¦ "
           href="/2025/03/31/%E4%BF%AE%E6%94%B9%E8%BF%9B%E7%A8%8B%E4%BF%A1%E6%81%AF%E7%9A%84%E5%86%85%E6%A0%B8%E6%A8%A1%E5%9D%97/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="ä¿®æ”¹è¿›ç¨‹ä¿¡æ¯çš„å†…æ ¸æ¨¡å—">ä¿®æ”¹è¿›ç¨‹ä¿¡æ¯çš„å†…æ ¸æ¨¡å—</span>
            <span class="post-date" title="2025-03-31 21:53:34">2025/03/31</span>
        </a>
        
        
        <a  class="å…¨éƒ¨æ–‡ç«  æ•…éšœæ’æŸ¥ "
           href="/2025/03/30/%E4%B8%80%E6%AC%A1%E4%B8%A2%E5%8C%85%E7%9A%84%E6%8E%92%E6%9F%A5/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="ä¸€æ¬¡ä¸¢åŒ…çš„æ’æŸ¥">ä¸€æ¬¡ä¸¢åŒ…çš„æ’æŸ¥</span>
            <span class="post-date" title="2025-03-30 12:56:05">2025/03/30</span>
        </a>
        
        
        <a  class="å…¨éƒ¨æ–‡ç«  æ•…éšœæ’æŸ¥ "
           href="/2025/03/29/systemd-resolved%E6%9C%8D%E5%8A%A1%E5%BC%82%E5%B8%B8/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="systemd-resolvedæœåŠ¡å¼‚å¸¸">systemd-resolvedæœåŠ¡å¼‚å¸¸</span>
            <span class="post-date" title="2025-03-29 22:28:32">2025/03/29</span>
        </a>
        
        
        <a  class="å…¨éƒ¨æ–‡ç«  æ•…éšœæ’æŸ¥ "
           href="/2025/03/22/rt%E8%B0%83%E5%BA%A6%E5%99%A8bug%E5%AF%BC%E8%87%B4%E5%AE%95%E6%9C%BA%E7%9A%84%E6%8E%92%E6%9F%A5/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="rtè°ƒåº¦å™¨bugå¯¼è‡´å®•æœºçš„æ’æŸ¥">rtè°ƒåº¦å™¨bugå¯¼è‡´å®•æœºçš„æ’æŸ¥</span>
            <span class="post-date" title="2025-03-22 21:08:39">2025/03/22</span>
        </a>
        
        
        <a  class="å…¨éƒ¨æ–‡ç«  OS "
           href="/2025/03/21/%E4%BF%AE%E6%94%B9debian%E5%86%85%E6%A0%B8%E6%BA%90%E7%A0%81%E5%B9%B6%E6%89%93%E5%8C%85/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="ä¿®æ”¹debianå†…æ ¸æºç å¹¶æ‰“åŒ…">ä¿®æ”¹debianå†…æ ¸æºç å¹¶æ‰“åŒ…</span>
            <span class="post-date" title="2025-03-21 21:53:56">2025/03/21</span>
        </a>
        
        
        <a  class="å…¨éƒ¨æ–‡ç«  æ•…éšœæ’æŸ¥ "
           href="/2025/03/17/%E8%AE%B0%E4%B8%80%E6%AC%A1%E4%BA%91%E7%9B%98%E7%83%AD%E6%8B%94%E5%A4%B1%E8%B4%A5/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="è®°ä¸€æ¬¡äº‘ç›˜çƒ­æ‹”å¤±è´¥">è®°ä¸€æ¬¡äº‘ç›˜çƒ­æ‹”å¤±è´¥</span>
            <span class="post-date" title="2025-03-17 22:02:52">2025/03/17</span>
        </a>
        
        
        <a  class="å…¨éƒ¨æ–‡ç«  ç¡¬ä»¶ "
           href="/2025/03/13/MMX%E3%80%81FMA%E3%80%81SSE%E4%B8%8EAVX/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="MMXã€FMAã€SSEä¸AVX">MMXã€FMAã€SSEä¸AVX</span>
            <span class="post-date" title="2025-03-13 21:37:54">2025/03/13</span>
        </a>
        
        
        <a  class="å…¨éƒ¨æ–‡ç«  æ–‡ä»¶ç³»ç»Ÿ "
           href="/2025/03/12/proc%E3%80%81sysctl%E5%92%8Csysfs/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="procã€sysctlå’Œsysfs">procã€sysctlå’Œsysfs</span>
            <span class="post-date" title="2025-03-12 22:00:23">2025/03/12</span>
        </a>
        
        
        <a  class="å…¨éƒ¨æ–‡ç«  å…¶ä»– "
           href="/2025/03/11/%E4%BF%AE%E6%94%B9bios%E9%85%8D%E7%BD%AE/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="ä¿®æ”¹biosé…ç½®">ä¿®æ”¹biosé…ç½®</span>
            <span class="post-date" title="2025-03-11 21:49:28">2025/03/11</span>
        </a>
        
        
        <a  class="å…¨éƒ¨æ–‡ç«  OS "
           href="/2025/03/10/%E4%BF%AE%E6%94%B9%E5%85%AC%E7%89%88%E5%86%85%E6%A0%B8/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="ä¿®æ”¹å…¬ç‰ˆå†…æ ¸">ä¿®æ”¹å…¬ç‰ˆå†…æ ¸</span>
            <span class="post-date" title="2025-03-10 22:13:00">2025/03/10</span>
        </a>
        
        
        <a  class="å…¨éƒ¨æ–‡ç«  power "
           href="/2025/03/09/proc-cpuinfo%E6%98%BE%E7%A4%BA%E9%A2%91%E7%8E%87%E5%8E%9F%E7%90%86/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="/proc/cpuinfoæ˜¾ç¤ºé¢‘ç‡åŸç†">/proc/cpuinfoæ˜¾ç¤ºé¢‘ç‡åŸç†</span>
            <span class="post-date" title="2025-03-09 22:00:49">2025/03/09</span>
        </a>
        
        
        <a  class="å…¨éƒ¨æ–‡ç«  OS "
           href="/2025/03/07/rsyslog%E9%85%8D%E7%BD%AE/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="rsyslogé…ç½®">rsyslogé…ç½®</span>
            <span class="post-date" title="2025-03-07 22:36:29">2025/03/07</span>
        </a>
        
        
        <a  class="å…¨éƒ¨æ–‡ç«  è™šæ‹ŸåŒ– "
           href="/2025/03/06/qemu-kvm%E6%B7%BB%E5%8A%A0%E6%96%B0feature%E8%99%9A%E6%8B%9F%E5%8C%96/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="qemu kvmæ·»åŠ æ–°featureè™šæ‹ŸåŒ–">qemu kvmæ·»åŠ æ–°featureè™šæ‹ŸåŒ–</span>
            <span class="post-date" title="2025-03-06 00:13:34">2025/03/06</span>
        </a>
        
        
        <a  class="å…¨éƒ¨æ–‡ç«  æ•…éšœæ’æŸ¥ "
           href="/2025/02/27/hung-task%E5%8E%9F%E7%90%86/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="hung taskåŸç†">hung taskåŸç†</span>
            <span class="post-date" title="2025-02-27 22:54:58">2025/02/27</span>
        </a>
        
        
        <a  class="å…¨éƒ¨æ–‡ç«  ç¡¬ä»¶ "
           href="/2025/02/26/netconsole/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="netconsole">netconsole</span>
            <span class="post-date" title="2025-02-26 23:01:56">2025/02/26</span>
        </a>
        
        
        <a  class="å…¨éƒ¨æ–‡ç«  ä¸ªäºº "
           href="/2025/02/26/%E8%88%92%E6%B4%BB%E8%88%92%E6%B4%BB%E7%AD%8B%E9%AA%A8%EF%BC%8C%E6%8A%96%E6%93%9E%E6%8A%96%E6%93%9E%E7%B2%BE%E7%A5%9E/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="èˆ’æ´»èˆ’æ´»ç­‹éª¨ï¼ŒæŠ–æ“æŠ–æ“ç²¾ç¥">èˆ’æ´»èˆ’æ´»ç­‹éª¨ï¼ŒæŠ–æ“æŠ–æ“ç²¾ç¥</span>
            <span class="post-date" title="2025-02-26 00:05:33">2025/02/26</span>
        </a>
        
        
        <a  class="å…¨éƒ¨æ–‡ç«  æ•…éšœæ’æŸ¥ "
           href="/2025/02/25/softlockup%E4%B8%8Ehardlockup/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="softlockupä¸hardlockup">softlockupä¸hardlockup</span>
            <span class="post-date" title="2025-02-25 22:13:35">2025/02/25</span>
        </a>
        
        
        <a  class="å…¨éƒ¨æ–‡ç«  ç½‘ç»œ "
           href="/2025/02/24/netpoll%E5%8E%9F%E7%90%86/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="netpollåŸç†">netpollåŸç†</span>
            <span class="post-date" title="2025-02-24 21:36:30">2025/02/24</span>
        </a>
        
        <div id="no-item-tips">

        </div>
    </nav>
    <div id="outline-list">
    </div>
</div>

    </div>
    <div class="hide-list">
        <div class="semicircle" data-title="åˆ‡æ¢å…¨å± å¿«æ·é”® s">
            <div class="brackets first"><</div>
            <div class="brackets">&gt;</div>
        </div>
    </div>
</aside>
<div id="post">
    <div class="pjax">
        <article id="post-kdumpå¤±è´¥é—®é¢˜æ’æŸ¥" class="article article-type-post" itemscope itemprop="blogPost">
    
        <h1 class="article-title">kdumpå¤±è´¥é—®é¢˜æ’æŸ¥</h1>
    
    <div class="article-meta">
        
        
        
        <span class="book">
            <i class="iconfont icon-category"></i>
            
            
            <a  data-rel="æ•…éšœæ’æŸ¥">æ•…éšœæ’æŸ¥</a>
            
        </span>
        
        
    </div>
    <div class="article-meta">
        
            å‘å¸ƒæ—¶é—´ : <time class="date" title='æœ€åæ›´æ–°: 2025-07-05 00:25:19'>2025-07-04 23:03</time>
        
    </div>
    <div class="article-meta">
        
        <span>å­—æ•°:6.1k</span>
        
        
        
        <span class="top-comment" title="è·³è½¬è‡³è¯„è®ºåŒº">
            <a href="#comments">
                è¯„è®º:<span class="count-comment">
                    <span class="spinner">
                      <div class="cube1"></div>
                      <div class="cube2"></div>
                    </span>
                </span>
            </a>
        </span>
        
    </div>
    
    <div class="toc-ref">
    
        <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%89%8D%E8%A8%80"><span class="toc-text">å‰è¨€</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8E%9F%E7%90%86"><span class="toc-text">åŸç†</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%85%8D%E7%BD%AEkdump"><span class="toc-text">é…ç½®kdump</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#kdump%E5%A4%B1%E8%B4%A5%E6%8E%92%E6%9F%A5"><span class="toc-text">kdumpå¤±è´¥æ’æŸ¥</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%83%8C%E6%99%AF"><span class="toc-text">èƒŒæ™¯</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8E%92%E6%9F%A5%E8%BF%87%E7%A8%8B"><span class="toc-text">æ’æŸ¥è¿‡ç¨‹</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%90%8E%E7%BB%AD"><span class="toc-text">åç»­</span></a></li></ol>
    
<style>
    .left-col .switch-btn,
    .left-col .switch-area {
        display: none;
    }
    .toc-level-3 i,
    .toc-level-3 ol {
        display: none !important;
    }
</style>
</div>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a><center>å‰è¨€</center></h3><p>å½“å‰ï¼Œå³ä½¿æ˜¯stableçš„å†…æ ¸ï¼Œä¹Ÿä¸æ˜¯é›¶bugçš„ã€‚æ—¢ç„¶æœ‰bugï¼Œå°±ä¼šåœ¨ä½¿ç”¨æ—¶å¯¼è‡´é—®é¢˜ï¼Œä¸¥é‡çš„ç”šè‡³ä¼šå¯¼è‡´å®•æœºã€‚</p>
<p>åœ¨Liunxç³»ç»Ÿä¸­ï¼Œkdumpç»å¯¹æ˜¯æ’æŸ¥å®•æœºçš„å¥½å¸®æ‰‹ã€‚å®ƒçš„ä½œç”¨æ˜¯æŠŠç³»ç»Ÿå®•æœºæ—¶çš„å†…å­˜dumpå‡ºæ¥ï¼Œä½¿äººä»¬å¯ä»¥æ ¹æ®dumpæ–‡ä»¶åˆ†æå®•æœºæ—¶çš„æƒ…å†µï¼ŒæŸ¥æ‰¾å®•æœºåŸå› ã€‚</p>
<h3 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a><center>åŸç†</center></h3><p>ç®€å•æ¥è¯´ï¼Œå°±æ˜¯ç³»ç»Ÿpanicçš„æ—¶å€™ï¼Œå¯åŠ¨ä¸€ä¸ªå°å†…æ ¸ï¼Œè¿™ä¸ªå°å†…æ ¸å¯åŠ¨æˆåŠŸä¹‹åä¼šæŠŠå½“å‰çš„å†…å­˜è¿›è¡Œdumpï¼Œå½¢æˆä¸€ä¸ªvmcoreæ–‡ä»¶ã€‚ç„¶åå°±å¯ä»¥é€šè¿‡è¿™ä¸ªvmcoreæ–‡ä»¶æ¥åˆ†æå®•æœºæ—¶çš„æƒ…å†µã€‚</p>
<p>è‡³äºpanicä¹‹åï¼Œæ€ä¹ˆå¯åŠ¨å°å†…æ ¸è¿™äº›ä»£ç ç»†èŠ‚ï¼Œåç»­å†è¯´ï¼ˆå¥½å§ï¼Œæˆ‘è¿˜æ²¡çœ‹ï¼‰ã€‚</p>
<h3 id="é…ç½®kdump"><a href="#é…ç½®kdump" class="headerlink" title="é…ç½®kdump"></a><center>é…ç½®kdump</center></h3><p>kdumpçš„é…ç½®ä¸»è¦å°±æ˜¯ä¸¤æ–¹é¢ï¼šé¢„ç•™å†…å­˜+kdumpæœåŠ¡</p>
<p>å¯¹äºcentosæ¥è¯´ï¼Œéœ€è¦åœ¨cmdlineæ·»åŠ crashkernel&#x3D;XXXå‚æ•°ï¼Œä»¥ä¾¿åœ¨ç³»ç»Ÿå¯åŠ¨æ—¶èƒ½å¤Ÿé¢„ç•™ä¸€éƒ¨åˆ†å†…å­˜ç”¨äºkdumpå°å†…æ ¸å¯åŠ¨ï¼›ç³»ç»Ÿå¯åŠ¨åï¼Œéœ€è¦å¼€å¯kdumpæœåŠ¡ï¼ŒkdumpæœåŠ¡çš„ä½œç”¨ä¹‹ä¸€æ—¶ä¼šåœ¨&#x2F;bootä¸‹åˆ¶ä½œkdump.imgï¼Œè¿™æ˜¯å°å†…æ ¸å¯åŠ¨æ—¶ä¼šç”¨çš„initramfs</p>
<p>å¯¹äºubuntuæ¥è¯´ï¼Œä¸ä¸Šé¢ç›¸åŒï¼Œä½†æ˜¯æœåŠ¡åå­—æ˜¯å«kdump-tools</p>
<h3 id="kdumpå¤±è´¥æ’æŸ¥"><a href="#kdumpå¤±è´¥æ’æŸ¥" class="headerlink" title="kdumpå¤±è´¥æ’æŸ¥"></a><center>kdumpå¤±è´¥æ’æŸ¥</center></h3><p>åœ¨å®é™…ä½¿ç”¨ä¸­ï¼Œä¹Ÿè®¸ä¼šå‘ç°ï¼Œå³ä½¿æŒ‰ç…§ä¸Šé¢çš„å†…å®¹è¿›è¡Œäº†é…ç½®ï¼Œç³»ç»Ÿå®•æœºåï¼Œä¹Ÿçœ‹ä¸åˆ°vmcoreçš„äº§ç”Ÿï¼Œå› æ­¤éœ€è¦æ’æŸ¥çœ‹dumpä¸ºä»€ä¹ˆä¼šå¤±è´¥ï¼Ÿ</p>
<p>kdumpå¤±è´¥å¯ä»¥å…ˆå°è¯•è¿™ä¸¤ä¸ªæ“ä½œ(æœ¬äººé‡åˆ°çš„æƒ…å†µä¸­ï¼Œå¤§å¤šä¸è¿™ä¸¤ä¸ªæœ‰å…³)ï¼š<font color="red">è°ƒå¤§é¢„ç•™å†…å­˜å’Œé‡æ–°åˆ¶ä½œkdump.img</font>ã€‚å¦‚æœæ’é™¤è¿™ä¸¤ä¸ªåŸå› ï¼Œå†å»ç»§ç»­å°è¯•å®šä½å…¶ä»–å¤±è´¥åŸå› ã€‚</p>
<p>ä¸‹é¢æä¸€ä¸ªå®é™…æ’æŸ¥è¿‡ç¨‹çœ‹ä¸€ä¸‹ï¼š</p>
<h4 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a><center>èƒŒæ™¯</center></h4><p>è¯¥é—®é¢˜çš„èƒŒæ™¯æ˜¯ï¼Œæµ‹è¯•å®•æœºçš„æ—¶å€™ï¼Œå‘ç°æ²¡æœ‰ç”Ÿæˆvmcoreï¼Œä¸”å®•æœºåä¸èƒ½æ¢å¤è¿›åˆ°æ­£å¸¸çš„ç³»ç»Ÿä¸­ï¼Œçœ‹ä¸²å£æ—¥å¿—å‘ç°ä¸€ç›´åœ¨ä¸‹å›¾ä¸­è¿›è¡Œæ­»å¾ªç¯</p>
<p><img src="/img/27.png" alt="è¿™æ˜¯ä¸€å¼ å›¾ç‰‡"></p>
<h4 id="æ’æŸ¥è¿‡ç¨‹"><a href="#æ’æŸ¥è¿‡ç¨‹" class="headerlink" title="æ’æŸ¥è¿‡ç¨‹"></a><center>æ’æŸ¥è¿‡ç¨‹</center></h4><p><strong>æ˜¯å¦è¿›å…¥å°å†…æ ¸ï¼Ÿ</strong></p>
<p>é¦–å…ˆéœ€è¦ç¡®è®¤çš„å°±æ˜¯ï¼Œè¿™ä¸ªæ­»å¾ªç¯æ˜¯å¤§å†…æ ¸è¿˜æ˜¯å°å†…æ ¸çš„å‘¢ï¼Ÿ</p>
<p>é€šè¿‡ä¸€äº›æ—¥å¿—åŠå…¶ä»–æ‰‹æ®µèƒ½å¤Ÿç¡®è®¤(åœ¨BMCå‘é‡å¯ï¼Œèƒ½å¤Ÿæ­£å¸¸è¿›å…¥ç³»ç»Ÿï¼Œè¯´æ˜è¿›å…¥å¤§å†…æ ¸çš„è¿‡ç¨‹æ²¡é—®é¢˜ï¼›å¦å¤–ï¼Œé€šè¿‡ä¸²å£æ—¥å¿—çš„cmdlineä¹Ÿèƒ½å‘ç°ç«¯å€ªï¼Œä¸ºäº†è®©å°å†…æ ¸ä½¿ç”¨å°½å¯èƒ½å°‘çš„é¢„ç•™å†…å­˜ï¼Œåœ¨é…ç½®kdumpè¿‡ç¨‹ä¸­ï¼Œä¼šåœ¨cmdlineæ·»åŠ ä¸€äº›blacklistï¼Œç¦æ­¢åŠ è½½ä¸€äº›é©±åŠ¨ä¹‹ç±»ï¼Œæ‰€ä»¥å¤§å°å†…æ ¸å¯åŠ¨æ—¶çš„cmdlineæ˜¯ä¸åŒçš„)ï¼Œ<font color="red">è¿™æ˜¯è¿›å…¥å°å†…æ ¸çš„æ­»å¾ªç¯</font>ã€‚</p>
<p><strong>è°ƒå¤§é¢„ç•™å†…å­˜å’Œé‡æ–°åˆ¶ä½œkdump.imgå°è¯•</strong></p>
<p>ç¡®è®¤æ˜¯èƒ½å¤ŸæˆåŠŸè¿›å…¥å°å†…æ ¸äº†ï¼Œå°±è¯¥ç›´æ¥å°è¯•ä¸Šé¢æåˆ°çš„ä¸¤æ¿æ–§äº†ã€‚</p>
<p>ç»è¿‡å°è¯•ï¼Œæ²¡ç”¨ã€‚</p>
<p><strong>ä¸²å£æ—¥å¿—åˆ†æ</strong></p>
<pre><code class="language-c">[32m  OK  [0m] Started Create Static Device Nodes in /dev.
         Starting udev Kernel Device Manager...
[[32m  OK  [0m] Started udev Kernel Device Manager.
         Starting udev Coldplug all Devices...
         Mounting Configuration File System...
[[32m  OK  [0m] Mounted Configuration File System.
[[32m  OK  [0m] Started udev Coldplug all Devices.
         Starting dracut initqueue hook...
[[32m  OK  [0m] Started dracut initqueue hook.
[[32m  OK  [0m] Reached target Remote File Systems (Pre).
[[32m  OK  [0m] Reached target Remote File Systems.
[[32m  OK  [0m] Reached target Initrd Root File System.
         Starting Reload Configuration from the Real Root...
[[32m  OK  [0m] Started Reload Configuration from the Real Root.
[[32m  OK  [0m] Reached target Initrd File Systems.
[[0m[31m*     [0m] A start job is running for dev-disk...233403b7c.device (5s / 1min 30s)
[K[[1;31m*[0m[31m*    [0m] A start job is running for dev-disk...233403b7c.device (6s / 1min 30s)
[K[[31m*[1;31m*[0m[31m*   [0m] A start job is running for dev-disk...233403b7c.device (6s / 1min 30s)
[K[ [31m*[1;31m*[0m[31m*  [0m] A start job is running for dev-disk...233403b7c.device (7s / 1min 30s)
[K[  [31m*[1;31m*[0m[31m* [0m] A start job is running for dev-disk...233403b7c.device (7s / 1min 30s)
[K[   [31m*[1;31m*[0m[31m*[0m] A start job is running for dev-disk...233403b7c.device (8s / 1min 30s)
[K[    [31m*[1;31m*[0m] A start job is running for dev-disk...233403b7c.device (8s / 1min 30s)
[K[     [31m*[0m] A start job is running for dev-disk...233403b7c.device (9s / 1min 30s)
[K[    [31m*[1;31m*[0m] A start job is running for dev-disk...233403b7c.device (9s / 1min 30s)
[K[   [31m*[1;31m*[0m[31m*[0m] A start job is running for dev-disk...33403b7c.device (10s / 1min 30s)
[K[  [31m*[1;31m*[0m[31m* [0m] A start job is running for dev-disk...33403b7c.device (10s / 1min 30s)
[K[ [31m*[1;31m*[0m[31m*  [0m] A start job is running for dev-disk...33403b7c.device (11s / 1min 30s)
[K[[31m*[1;31m*[0m[31m*   [0m] A start job is running for dev-disk...33403b7c.device (11s / 1min 30s)
[K[[1;31m*[0m[31m*    [0m] A start job is running for dev-disk...33403b7c.device (12s / 1min 30s)
[K[[0m[31m*     [0m] A start job is running for dev-disk...33403b7c.device (12s / 1min 30s)
[K[[1;31m*[0m[31m*    [0m] A start job is running for dev-disk...33403b7c.device (13s / 1min 30s)
[K[[31m*[1;31m*[0m[31m*   [0m] A start job is running for dev-disk...33403b7c.device (13s / 1min 30s)
[K[ [31m*[1;31m*[0m[31m*  [0m] A start job is running for dev-disk...33403b7c.device (14s / 1min 30s)
[K[  [31m*[1;31m*[0m[31m* [0m] A start job is running for dev-disk...33403b7c.device (14s / 1min 30s)
[K[   [31m*[1;31m*[0m[31m*[0m] A start job is running for dev-disk...33403b7c.device (15s / 1min 30s)
[K[    [31m*[1;31m*[0m] A start job is running for dev-disk...33403b7c.device (15s / 1min 30s)
[K[     [31m*[0m] A start job is running for dev-disk...33403b7c.device (16s / 1min 30s)
[K[    [31m*[1;31m*[0m] A start job is running for dev-disk...33403b7c.device (16s / 1min 30s)
[K[   [31m*[1;31m*[0m[31m*[0m] A start job is running for dev-disk...33403b7c.device (17s / 1min 30s)
[K[  [31m*[1;31m*[0m[31m* [0m] A start job is running for dev-disk...33403b7c.device (17s / 1min 30s)
[K[ [31m*[1;31m*[0m[31m*  [0m] A start job is running for dev-disk...33403b7c.device (18s / 1min 30s)
[K[[31m*[1;31m*[0m[31m*   [0m] A start job is running for dev-disk...33403b7c.device (18s / 1min 30s)
[K[[1;31m*[0m[31m*    [0m] A start job is running for dev-disk...33403b7c.device (19s / 1min 30s)
[K[[0m[31m*     [0m] A start job is running for dev-disk...33403b7c.device (19s / 1min 30s)
[K[[1;31m*[0m[31m*    [0m] A start job is running for dev-disk...33403b7c.device (20s / 1min 30s)
[K[[31m*[1;31m*[0m[31m*   [0m] A start job is running for dev-disk...33403b7c.device (20s / 1min 30s)
[K[ [31m*[1;31m*[0m[31m*  [0m] A start job is running for dev-disk...33403b7c.device (21s / 1min 30s)
[K[  [31m*[1;31m*[0m[31m* [0m] A start job is running for dev-disk...33403b7c.device (21s / 1min 30s)
[K[   [31m*[1;31m*[0m[31m*[0m] A start job is running for dev-disk...33403b7c.device (22s / 1min 30s)
[K[    [31m*[1;31m*[0m] A start job is running for dev-disk...33403b7c.device (22s / 1min 30s)
[K[     [31m*[0m] A start job is running for dev-disk...33403b7c.device (23s / 1min 30s)
[K[    [31m*[1;31m*[0m] A start job is running for dev-disk...33403b7c.device (23s / 1min 30s)
[K[   [31m*[1;31m*[0m[31m*[0m] A start job is running for dev-disk...33403b7c.device (24s / 1min 30s)
[K[  [31m*[1;31m*[0m[31m* [0m] A start job is running for dev-disk...33403b7c.device (24s / 1min 30s)
[K[ [31m*[1;31m*[0m[31m*  [0m] A start job is running for dev-disk...33403b7c.device (25s / 1min 30s)
[K[[31m*[1;31m*[0m[31m*   [0m] A start job is running for dev-disk...33403b7c.device (25s / 1min 30s)
[K[[1;31m*[0m[31m*    [0m] A start job is running for dev-disk...33403b7c.device (26s / 1min 30s)
</code></pre>
<p>åˆ†æä¸€æ‰‹ä¸²å£æ—¥å¿—ï¼Œå¯ä»¥å‘ç°ï¼Œè¿™ä¸ªæ­»å¾ªç¯ä¼¼ä¹æ˜¯åœ¨è¿›è¡Œç›˜ç›¸å…³çš„å·¥ä½œï¼Ÿdev-diskâ€¦33403b7c.deviceï¼Ÿï¼Ÿ</p>
<p>æ¥ä¸‹æ¥æ­£å¸¸è¿›å…¥ç³»ç»Ÿï¼ŒæŸ¥ä¸€ä¸‹æœ‰æ²¡æœ‰è¿™ä¸ªidï¼Ÿ</p>
<p><img src="/img/28.png" alt="è¿™æ˜¯ä¸€å¼ å›¾ç‰‡"></p>
<p>æ˜¯æœ‰çš„ï¼Œè€Œä¸”æ­£å·§è¿™ä¸ªç›˜å°±æ˜¯ç³»ç»Ÿç›˜</p>
<p><img src="/img/29.png" alt="è¿™æ˜¯ä¸€å¼ å›¾ç‰‡"></p>
<p>æ‰€ä»¥ï¼Œè¿™é‡Œæˆ‘ä»¬å°±å¯ä»¥ç¡®å®šï¼Œè¿™æ˜¯<font color="red">å°å†…æ ¸æŒ‚è½½ç³»ç»Ÿç›˜å¤±è´¥ï¼Œå¯¼è‡´å°å†…æ ¸å¯åŠ¨å¤±è´¥ï¼Œå¯¼è‡´kdumpå¤±è´¥</font></p>
<p><strong>è§£åŒ…kdump.imgæŸ¥çœ‹</strong></p>
<p>æŠŠå¼‚å¸¸æœºå™¨çš„kdump.imgè§£åŒ…ï¼Œä¸æ­£å¸¸èƒ½å¤ŸkdumpæˆåŠŸçš„æœºå™¨ä¸Šçš„kdump.imgè¿›è¡Œå¯¹æ¯”ï¼Œå‘ç°æ²¡ä»€ä¹ˆä¸åŒï¼Œæ‰€ä»¥è¿™é‡Œå°±å½»åº•æ’é™¤äº†kdump.imgçš„é—®é¢˜</p>
<p>é‚£è¿™é‡Œå°±æœ‰äº›æ€€ç–‘ï¼Œ<font color="red">éš¾ä¸æˆï¼Œå¯åŠ¨å°å†…æ ¸çš„è¿‡ç¨‹ä¸­ï¼Œç›˜çš„uuidå˜äº†ï¼Ÿå¯¼è‡´fstabä¸­çš„idè¯†åˆ«ä¸åˆ°äº†ï¼Ÿ</font></p>
<p><strong>å°å†…æ ¸æ–­ç‚¹</strong></p>
<p>&#x2F;etc&#x2F;sysconfig&#x2F;kdumpä¸­çš„cmdlineæ·»åŠ rd.break&#x3D;initqueueï¼Œç„¶åå†æ¬¡è§¦å‘å®•æœºï¼Œè¿™æ—¶å€™å°å†…æ ¸åº”è¯¥å°±åœ¨æ­»å¾ªç¯ä¹‹å‰ï¼Œè¿›å…¥emergency shelläº†ï¼Œèƒ½å¤Ÿä½¿ç”¨ä¸€äº›åŸºç¡€shellå‘½ä»¤è¿›è¡Œæ’æŸ¥</p>
<p>åœ¨emergency shellä¸­ls -l &#x2F;dev&#x2F;disk&#x2F;by-uuidçœ‹ä¸€ä¸‹ï¼Œå‘ç°ï¼Œæ ¹æœ¬å°±æ²¡æœ‰é‚£ä¸ªuuidå¯¹åº”çš„ç›˜ã€‚</p>
<p>æ‰€ä»¥ï¼Œä¸æ˜¯ç³»ç»Ÿç›˜çš„uuidå˜äº†ï¼Œè€Œæ˜¯å‹æ ¹å°±æ²¡æœ‰è¯†åˆ«åˆ°ç³»ç»Ÿç›˜</p>
<p>ä¸ºä»€ä¹ˆå‘¢ï¼Ÿå› ä¸ºæˆ‘è¿™ä¸ªæœºå™¨çš„ç³»ç»Ÿç›˜æ˜¯virtio-blkçš„äº‘ç›˜ï¼Ÿ</p>
<p>ä½†æ˜¯æ ¹æ®ç³»ç»Ÿç›˜çš„pci bdfï¼ˆä»æ­£å¸¸ç³»ç»Ÿä¸­å¯ä»¥æ‹¿åˆ°ï¼‰èƒ½å¤Ÿçœ‹åˆ°å·²ç»åŠ è½½äº†virtio-pcié©±åŠ¨ï¼Œè€Œä¸”&#x2F;sys&#x2F;bus&#x2F;pci&#x2F;driverså¯ä»¥çœ‹åˆ°virtioç›¸å…³çš„é©±åŠ¨ä¹Ÿéƒ½åŠ è½½äº†</p>
<p>æ‰€ä»¥ï¼Œ<font color="red">è¿™æ˜¯udevçš„é—®é¢˜äº†ï¼Ÿéš¾ä¸æˆæ˜¯udevæ²¡æœ‰å¤„ç†ç³»ç»Ÿç›˜probeçš„æ—¶å€™å‘å‡ºçš„ueventï¼Ÿ</font></p>
<p><strong>é‡æ–°ç»‘å®šé©±åŠ¨å®éªŒ</strong></p>
<p>å…ˆçœ‹ä¸€ä¸ªnvmeç›˜çš„unbind bindçš„ç°è±¡ï¼šå¯ä»¥çœ‹å‡ºï¼Œnvmeç›˜unbindé©±åŠ¨ä¹‹åï¼Œusrçœ‹ä¸åˆ°äº†ï¼Œé‡æ–°bindä¹‹åï¼Œusrèƒ½çœ‹åˆ°è¿™ä¸ªè®¾å¤‡äº†ã€‚ç¬¦åˆé¢„æœŸ</p>
<pre><code class="language-c">initqueue:/# ls /dev/disk/by-path -l
total 0
lrwxrwxrwx 1 root 0 13 Jul  3 03:51 pci-0000:01:00.0-nvme-1 -&gt; ../../nvme0n1
lrwxrwxrwx 1 root 0  9 Jul  3 03:51 pci-0000:93:00.0-ata-1.0 -&gt; ../../sda
lrwxrwxrwx 1 root 0 10 Jul  3 03:51 pci-0000:93:00.0-ata-1.0-part1 -&gt; ../../sda1
lrwxrwxrwx 1 root 0 13 Jul  3 03:51 pci-0000:a7:00.0-nvme-1 -&gt; ../../nvme1n1


initqueue:/sys/bus/pci/drivers/nvme# cd /sys/bus/pci/drivers/nvme
initqueue:/sys/bus/pci/drivers/nvme# ls
0000:01:00.0  0000:a7:00.0  bind  module  new_id  remove_id  uevent  unbind
initqueue:/sys/bus/pci/drivers/nvme# echo 0000:01:00.0 &gt; unbind
initqueue:/sys/bus/pci/drivers/nvme# ls /dev/disk/by-path/ -l
total 0
lrwxrwxrwx 1 root 0  9 Jul  3 03:52 pci-0000:93:00.0-ata-1.0 -&gt; ../../sda
lrwxrwxrwx 1 root 0 10 Jul  3 03:52 pci-0000:93:00.0-ata-1.0-part1 -&gt; ../../sda1
lrwxrwxrwx 1 root 0 13 Jul  3 03:52 pci-0000:a7:00.0-nvme-1 -&gt; ../../nvme1n1

initqueue:/sys/bus/pci/drivers/nvme# echo 0000:01:00.0 &gt; bind
initqueue:/sys/bus/pci/drivers/nvme# ls /dev/disk/by-path/ -l
total 0
lrwxrwxrwx 1 root 0 13 Jul  3 03:54 pci-0000:01:00.0-nvme-1 -&gt; ../../nvme0n1
lrwxrwxrwx 1 root 0  9 Jul  3 03:54 pci-0000:93:00.0-ata-1.0 -&gt; ../../sda
lrwxrwxrwx 1 root 0 10 Jul  3 03:54 pci-0000:93:00.0-ata-1.0-part1 -&gt; ../../sda1
lrwxrwxrwx 1 root 0 13 Jul  3 03:54 pci-0000:a7:00.0-nvme-1 -&gt; ../../nvme1n1
</code></pre>
<p>å†æ¥çœ‹ç³»ç»Ÿäº‘ç›˜çš„è¿‡ç¨‹(bdfå¯ä»¥ä»æ­£å¸¸ç³»ç»Ÿä¸­è·å¾—)</p>
<pre><code class="language-c">initqueue:/# cd /sys/bus/pci/drivers/virtio-pci
initqueue:/sys/bus/pci/drivers/virtio-pci# ls
0000:1d:00.0  0000:21:00.0  bind  module  new_id  remove_id  uevent  unbind
initqueue:/sys/bus/pci/drivers/virtio-pci# echo 0000:1d:00.0 &gt; unbind
initqueue:/sys/bus/pci/drivers/virtio-pci# echo 0000:1d:00.0 &gt; bind

initqueue:/sys/bus/pci/drivers/virtio-pci# ls /dev/disk/by-path -l
total 0
lrwxrwxrwx 1 root 0 13 Jul  3 03:55 pci-0000:01:00.0-nvme-1 -&gt; ../../nvme0n1
lrwxrwxrwx 1 root 0  9 Jul  3 03:55 pci-0000:93:00.0-ata-1.0 -&gt; ../../sda
lrwxrwxrwx 1 root 0 10 Jul  3 03:55 pci-0000:93:00.0-ata-1.0-part1 -&gt; ../../sda1
lrwxrwxrwx 1 root 0 13 Jul  3 03:55 pci-0000:a7:00.0-nvme-1 -&gt; ../../nvme1n1
</code></pre>
<p><font color="red">æ‰‹åŠ¨bindé©±åŠ¨ï¼Œä¹Ÿæ²¡æœ‰åœ¨usrå±‚åˆ›å»ºè®¾å¤‡ï¼Œä¸ºä»€ä¹ˆï¼Ÿ</font></p>
<p><strong>udevadmæµ‹è¯•</strong></p>
<p>å…ˆunbind virtio-pcié©±åŠ¨ï¼Œç„¶åä½¿ç”¨udevadm monitorè¿›è¡Œç›‘æ§ï¼Œç„¶åå†æ¬¡bindé©±åŠ¨ï¼Œå‘ç°ï¼Œlogä¸­çš„å†…å®¹æ˜¯ç©ºçš„</p>
<pre><code class="language-c">initqueue:/# cd /sys/bus/pci/drivers/virtio-pci
initqueue:/sys/bus/pci/drivers/virtio-pci# echo 0000:1d:00.0 &gt; unbind
    
udevadm monitor --property &gt; log 2&gt;&amp;1 &amp;
    
initqueue:/sys/bus/pci/drivers/virtio-pci# echo 0000:1d:00.0 &gt; bind
</code></pre>
<p>å¯¹nvmeç›˜è¿›è¡Œä¸Šè¿°ç›¸åŒçš„æ“ä½œï¼Œå¯ä»¥æŠ“åˆ°udeväº‹ä»¶</p>
<p><font color="red">è¯´æ˜udevå°±æ˜¯æ²¡æœ‰æ”¶åˆ°ueventå¹¶å¤„ç†ï¼Œæˆ–è€…ï¼Œé©±åŠ¨å°±æ²¡æœ‰å‘é€ueventï¼Ÿ</font></p>
<p><strong>å†çœ‹ä¸²å£ä¿¡æ¯</strong></p>
<pre><code class="language-c">initqueue:/# dmesg |grep -i blk -A 5 -B 5
[   57.333334] xhci_hcd 0000:ec:00.4: request interrupt 251 failed
[   57.333335] xhci_hcd 0000:ec:00.4: startup error -28
[   57.333336] xhci_hcd 0000:ec:00.4: USB bus 3 deregistered
[   57.334354] xhci_hcd 0000:ec:00.4: init 0000:ec:00.4 fail, -28
[   57.334356] xhci_hcd: probe of 0000:ec:00.4 failed with error -28
[   58.031020] virtio_blk virtio0: 1/0/0 default/read/poll queues    ###############è¿™é‡Œæ˜¯init_vqæ‰“å°çš„log
[   58.031863] virtio_blk: probe of virtio0 failed with error -28
[   61.036705] systemd-udevd (414) used greatest stack depth: 12288 bytes left
[  145.292866] hugepage is reduced from total 503797 to 0
[  235.510818] hugepage is reduced from total 503797 to 0
[  325.783468] hugepage is reduced from total 503797 to 0
</code></pre>
<p>è¿™é‡Œå¯ä»¥çœ‹åˆ°ï¼Œä¹‹å‰å¿½ç•¥äº†ä¸€äº›logï¼Œ<font color="red">virtio-blké©±åŠ¨probeå¤±è´¥äº†ï¼</font></p>
<p>ä½†æ˜¯é©±åŠ¨ä¸ºä»€ä¹ˆprobeå¤±è´¥å‘¢ï¼Ÿå…ˆçœ‹err codeï¼Œ-28ï¼ŒENOSPCï¼ŒNo space left on device</p>
<p>ä½†æ˜¯ï¼Œå¤§æ¦‚çœ‹äº†ä¸€ä¸‹ï¼Œå®åœ¨ä¸èƒ½ç¡®å®šæ˜¯å“ªé‡Œè¿”å›äº†ENOSPC</p>
<p><strong>æ·»åŠ debugä¿¡æ¯é‡ç¼–virtio-blk</strong></p>
<p>å¦‚æ­¤ï¼Œåªèƒ½å¾€virtblk_probeå‡½æ•°ä¸­åŠ ç‚¹debugæ—¥å¿—ç„¶åæ·»åŠ åˆ°hostå†…æ ¸ï¼Œç„¶åé‡åškdump.imgï¼Œçœ‹ä¸€ä¸‹èƒ½ä¸èƒ½ç¼©å°æ’æŸ¥èŒƒå›´äº†ï¼Œè¿‡ç¨‹å¦‚ä¸‹ï¼š</p>
<p>å…ˆåœ¨virtblk_probeå‡½æ•°ä¸­æ¯ä¸ªerråéƒ½æ·»åŠ debugä¿¡æ¯ï¼Œé‡ç¼–virtio-blkæ¨¡å—</p>
<p>åˆ°å¼‚å¸¸æœºå™¨æŸ¥æ‰¾find &#x2F;usr&#x2F;lib&#x2F;modules&#x2F;<code>uname -r</code> -name virtio_blk.koæ‰¾åˆ°æ¨¡å—ä½ç½®ï¼Œå¤‡ä»½ï¼Œç„¶åç”¨æ–°æ¨¡å—æ›¿æ¢</p>
<p>åˆ é™¤æ—§çš„kdump.imgå¹¶åˆ¶ä½œé‡å¯kdumpæœåŠ¡ä»¥åˆ¶ä½œæ–°çš„kdump.img</p>
<p>å†æ¬¡å®•æœºè¿›å…¥å°å†…æ ¸ï¼ŒæŸ¥çœ‹dmesg</p>
<pre><code class="language-c">initqueue:/# dmesg |grep blk
[   56.909688] virtio_blk: loading out-of-tree module taints kernel.
[   56.910275] virtio_blk virtio0: 1/0/0 default/read/poll queues
[   56.911186] virtio_blk virtio0: init_vq err is -28
[   56.911188] virtio_blk: probe of virtio0 failed with error -28
</code></pre>
<p>å¦‚æ­¤ï¼Œ<font color="red">å¯ä»¥ç¡®å®šï¼Œå°±æ˜¯virtblk_probe-&gt;init_vqè¿™é‡Œå¤±è´¥äº†ï¼Œå¯¼è‡´é©±åŠ¨probeå¤±è´¥</font></p>
<p><strong>è¿½è¸ªä»£ç </strong></p>
<p>é€šè¿‡æŸ¥çœ‹init_vqå‡½æ•°ä½“ï¼Œå¯ä»¥æ˜æ˜¾å‘ç°ï¼Œåªæœ‰ä¸¤å¤„ä¸ºerr&#x3D;èµ‹è¿”å›å€¼çš„ï¼Œä¸€å¤„åœ¨virtio_cread_featureï¼Œä¸€å¤„åœ¨virtio_find_vqs</p>
<p>è€Œvirtio_cread_featureå¤„å¤±è´¥æ˜¯ç»å¯¹ä¸å¯èƒ½çš„ï¼Œå¯ä»¥çœ‹åˆ°ï¼Œå¦‚æœè¿™é‡Œå¤±è´¥çš„è¯ï¼Œå°±ä¸å¯èƒ½ä¼šåœ¨dmesgä¸­æ‰“å°åé¢çš„default&#x2F;read&#x2F;poll queues logäº†</p>
<pre><code class="language-c">err = virtio_cread_feature(vdev, VIRTIO_BLK_F_MQ,
                   struct virtio_blk_config, num_queues,
                   &amp;num_vqs);
    if (err)
        num_vqs = 1;

    if (!err &amp;&amp; !num_vqs) &#123;
        dev_err(&amp;vdev-&gt;dev, &quot;MQ advertised but zero queues reported\n&quot;);
        return -EINVAL;
    &#125;
....
dev_info(&amp;vdev-&gt;dev, &quot;%d/%d/%d default/read/poll queues\n&quot;,
                vblk-&gt;io_queues[HCTX_TYPE_DEFAULT],
                vblk-&gt;io_queues[HCTX_TYPE_READ],
                vblk-&gt;io_queues[HCTX_TYPE_POLL]);
</code></pre>
<p>æ‰€ä»¥ï¼ŒçœŸç›¸åªæœ‰ä¸€ä¸ªï¼Œé‚£å°±æ˜¯åœ¨virtio_find_vqså¤±è´¥äº†</p>
<pre><code class="language-c">static inline
int virtio_find_vqs(struct virtio_device *vdev, unsigned nvqs,
            struct virtqueue *vqs[], vq_callback_t *callbacks[],
            const char * const names[],
            struct irq_affinity *desc)
&#123;
    return vdev-&gt;config-&gt;find_vqs(vdev, nvqs, vqs, callbacks, names, NULL, desc);
&#125;
</code></pre>
<p>è€Œè¿™é‡Œå¯ä»¥çœ‹åˆ°å…¶å®æ˜¯è°ƒç”¨çš„config-&gt;find_vqsï¼Œç»è¿‡æŸ¥æ‰¾ï¼Œè¿™é‡Œåº”è¯¥æ˜¯vp_find_vqsæˆ–vp_modern_find_vqs</p>
<p>å¤§è‡´çœ‹äº†ä¸‹è¿™ä¿©å‡½æ•°ï¼Œä¸ç®¡legacyè¿˜æ˜¯modernçš„å§ï¼Œå‡ºé”™åº”è¯¥éƒ½æ˜¯åœ¨è°ƒç”¨vp_find_vqså‡½æ•°ä¸­å¤±è´¥çš„</p>
<pre><code class="language-c">int vp_find_vqs(struct virtio_device *vdev, unsigned int nvqs,
        struct virtqueue *vqs[], vq_callback_t *callbacks[],
        const char * const names[], const bool *ctx,
        struct irq_affinity *desc)
&#123;
    int err;

    /* Try MSI-X with one vector per queue. */
    err = vp_find_vqs_msix(vdev, nvqs, vqs, callbacks, names, true, ctx, desc);
    if (!err)
        return 0;
    /* Fallback: MSI-X with one vector for config, one shared for queues. */
    err = vp_find_vqs_msix(vdev, nvqs, vqs, callbacks, names, false, ctx, desc);
    if (!err)
        return 0;
    /* Is there an interrupt? If not give up. */
    if (!(to_vp_device(vdev)-&gt;pci_dev-&gt;irq))
        return err;
    /* Finally fall back to regular interrupts. */
    return vp_find_vqs_intx(vdev, nvqs, vqs, callbacks, names, ctx);
&#125;
</code></pre>
<p>è¿™ä¸ªçœ‹ä¸Šå»åº”è¯¥æ˜¯åˆ†é…ä¸­æ–­ä¹‹ç±»çš„ï¼ŸæŒ‰ç…§å‡½æ•°ä½“ï¼Œåº”è¯¥æ˜¯vp_find_vqs_msixã€vp_find_vqs_msixâ€¦â€¦ä¸€è·¯å¤±è´¥ï¼Œèµ°åˆ°æœ€åï¼Œåªèƒ½return vp_find_vqs_intxï¼Œä½†æ˜¯æ²¡æƒ³åˆ°è¿™ä¸ªä¹Ÿå¤±è´¥äº†ï¼Œè¿”å›äº†ENOSPC</p>
<p>å…¶å®çœ‹è¿™ä¸ªæ„æ€ï¼Œåªè¦è¿™äº›å‡½æ•°é‡Œèƒ½æˆåŠŸä¸€ä¸ªï¼Œèƒ½ç”³è¯·åˆ°ä¸­æ–­å°±å¥½ï¼Œä½†æ˜¯å°å†…æ ¸ä¸­ä¸€ä¸ªä¹Ÿæ²¡æœ‰æˆåŠŸ</p>
<p>çœ‹ä¸€ä¸‹è¿™ä¸ªå‡½æ•°</p>
<pre><code class="language-c">static int vp_find_vqs_intx(struct virtio_device *vdev, unsigned int nvqs,
        struct virtqueue *vqs[], vq_callback_t *callbacks[],
        const char * const names[], const bool *ctx)
&#123;
    struct virtio_pci_device *vp_dev = to_vp_device(vdev);
    int i, err, queue_idx = 0;

    vp_dev-&gt;vqs = kcalloc(nvqs, sizeof(*vp_dev-&gt;vqs), GFP_KERNEL);
    if (!vp_dev-&gt;vqs)
        return -ENOMEM;

    err = request_irq(vp_dev-&gt;pci_dev-&gt;irq, vp_interrupt, IRQF_SHARED,
            dev_name(&amp;vdev-&gt;dev), vp_dev);
    if (err)
        goto out_del_vqs;

    vp_dev-&gt;intx_enabled = 1;
    vp_dev-&gt;per_vq_vectors = false;
    for (i = 0; i &lt; nvqs; ++i) &#123;
        if (!names[i]) &#123;
            vqs[i] = NULL;
            continue;
        &#125;
        vqs[i] = vp_setup_vq(vdev, queue_idx++, callbacks[i], names[i],
                     ctx ? ctx[i] : false,
                     VIRTIO_MSI_NO_VECTOR);
        if (IS_ERR(vqs[i])) &#123;
            err = PTR_ERR(vqs[i]);
            goto out_del_vqs;
        &#125;
    &#125;

    return 0;
out_del_vqs:
    vp_del_vqs(vdev);
    return err;
&#125;
</code></pre>
<p>å¾ˆæ˜æ˜¾ï¼Œåªæœ‰å¯èƒ½æ˜¯request_irqå¤±è´¥å•¦ï¼Œè€Œrequest_irqå…¶å®æ˜¯è°ƒç”¨request_threaded_irq</p>
<p>ä¸è¿‡å†å¾€ä¸‹åˆä¸å¥½åˆ†æäº†</p>
<p>å¥½åœ¨ï¼Œdebugfsè¿˜æ˜¯èƒ½mountä¸Šçš„ï¼Œmount -t debugfs none &#x2F;sys&#x2F;kernel&#x2F;debug</p>
<p>ç„¶åfunction_graphæŠ“ä¸€ä¸‹request_threaded_irqï¼Œå¦‚ä¸‹</p>
<pre><code class="language-c">initqueue:/# cat log
# tracer: function_graph
#
# CPU  DURATION                  FUNCTION CALLS
# |     |   |                     |   |   |   |
 0)               |  request_threaded_irq() &#123;
 0)   0.381 us    |    irq_to_desc();
 0)               |    kmalloc_trace() &#123;
 0)               |      __kmem_cache_alloc_node() &#123;
 0)   0.080 us    |        should_failslab();
 0)   0.240 us    |      &#125;
 0)   0.491 us    |    &#125;
 0)   0.080 us    |    irq_chip_pm_get();
 0)               |    __setup_irq() &#123;
 0)   0.070 us    |      try_module_get();
 0)   0.091 us    |      mutex_lock();
 0)               |      _raw_spin_lock_irqsave() &#123;
 0)   0.100 us    |        preempt_count_add();
 0)   0.250 us    |      &#125;
 0)               |      irq_activate() &#123;
 0)               |        irq_domain_activate_irq() &#123;
 0)               |          __irq_domain_activate_irq() &#123;
 0)               |            __irq_domain_activate_irq() &#123;
 0)               |              __irq_domain_activate_irq() &#123;
 0)               |                x86_vector_activate() &#123;
 0)   0.060 us    |                  apic_chip_data.part.23();
 0)               |                  _raw_spin_lock_irqsave() &#123;
 0)   0.070 us    |                    preempt_count_add();
 0)   0.200 us    |                  &#125;
 0)   0.061 us    |                  apic_chip_data.part.23();
 0)               |                  assign_irq_vector_any_locked() &#123;
 0)               |                    assign_vector_locked() &#123;
 0)   0.070 us    |                      apic_chip_data.part.23();
 0)   0.120 us    |                      irq_matrix_alloc();
 0)   0.441 us    |                    &#125;
 0)               |                    assign_vector_locked() &#123;
 0)   0.071 us    |                      apic_chip_data.part.23();
 0)   0.090 us    |                      irq_matrix_alloc();
 0)   0.331 us    |                    &#125;
 0)   1.022 us    |                  &#125;
 0)               |                  _raw_spin_unlock_irqrestore() &#123;
 0)   0.061 us    |                    preempt_count_sub();
 0)   0.191 us    |                  &#125;
 0)   1.915 us    |                &#125;
 0)   2.065 us    |              &#125;
 0)   2.175 us    |            &#125;
 0)   2.385 us    |          &#125;
 0)   2.506 us    |        &#125;
 0)   2.646 us    |      &#125;
 0)               |      _raw_spin_unlock_irqrestore() &#123;
 0)   0.090 us    |        preempt_count_sub();
 0)   0.250 us    |      &#125;
 0)   0.080 us    |      mutex_unlock();
 0)   0.080 us    |      module_put();
 0)   4.189 us    |    &#125;
 0)   0.091 us    |    irq_chip_pm_put();
 0)   0.090 us    |    kfree();
 0)               |    kfree() &#123;
 0)   0.191 us    |      __kmem_cache_free();
 0)   0.341 us    |    &#125;
 0)   7.898 us    |  &#125;
 
 

    retval = __setup_irq(irq, desc, action);
    if (retval) &#123;
        irq_chip_pm_put(&amp;desc-&gt;irq_data);
        kfree(action-&gt;secondary);
        kfree(action);
    &#125;
</code></pre>
<p>èƒ½å¤Ÿæ˜æ˜¾çœ‹åˆ°ï¼Œ<font color="red">__setup_irqä¹‹åå»è°ƒç”¨irq_chip_pm_putï¼Œè¿™è¯´æ˜è¿™æ—¶å€™retvalè‚¯å®šå°±æ˜¯é‚£ä¸ªENOSPCäº†</font></p>
<p>å¯¹ç€è¿™ä¸ªtraceå†çœ‹ä¸€ä¸‹ï¼Œè¿™é‡Œçœ‹ä¸Šå»å°±æ˜¯åˆ†irqåˆ†ä¸å‡ºæ¥äº†ï¼Œçœ‹irq_matrix_allocæœ‰æ²¡æœ‰ENOSPCï¼Ÿ</p>
<pre><code class="language-c">int irq_matrix_alloc(struct irq_matrix *m, const struct cpumask *msk,
             bool reserved, unsigned int *mapped_cpu)
&#123;
    unsigned int cpu, bit;
    struct cpumap *cm;

    /*
     * Not required in theory, but matrix_find_best_cpu() uses
     * for_each_cpu() which ignores the cpumask on UP .
     */
    if (cpumask_empty(msk))
        return -EINVAL;

    cpu = matrix_find_best_cpu(m, msk);
    if (cpu == UINT_MAX)
        return -ENOSPC;

    cm = per_cpu_ptr(m-&gt;maps, cpu);
    bit = matrix_alloc_area(m, cm, 1, false);
    if (bit &gt;= m-&gt;alloc_end)
        return -ENOSPC;
    cm-&gt;allocated++;
    cm-&gt;available--;
    m-&gt;total_allocated++;
    m-&gt;global_available--;
    if (reserved)
        m-&gt;global_reserved--;
    *mapped_cpu = cpu;
    trace_irq_matrix_alloc(bit, cpu, m, cm);
    return bit;

&#125;
</code></pre>
<p>å†çœ‹ä¸€ä¸‹å½“å‰çš„ä¸­æ–­æƒ…å†µ</p>
<pre><code class="language-c">initqueue:/# cat /proc/interrupts
           CPU0
  0:         67  IR-IO-APIC   2-edge      timer
  4:       7480  IR-IO-APIC   4-edge      ttyS0
  8:          1  IR-IO-APIC   8-edge      rtc0
  9:          0  IR-IO-APIC   9-fasteoi   acpi
 29:          0  IOMMU-MSI   0-edge      AMD-Vi
 30:          0  IOMMU-MSI   0-edge      AMD-Vi
 31:          0  IOMMU-MSI   0-edge      AMD-Vi
 32:          0  IOMMU-MSI   0-edge      AMD-Vi
 33:          0  IOMMU-MSI   0-edge      AMD-Vi
 34:          0  IOMMU-MSI   0-edge      AMD-Vi
 35:          0  IOMMU-MSI   0-edge      AMD-Vi
 36:          0  IOMMU-MSI   0-edge      AMD-Vi
 38:          0  IR-PCI-MSI 6144-edge      PCIe PME
 39:          0  IR-PCI-MSI 18432-edge      PCIe PME, pciehp
 40:          0  IR-PCI-MSI 20480-edge      PCIe PME, pciehp
 41:          0  IR-PCI-MSI 22528-edge      PCIe PME, pciehp
 42:          0  IR-PCI-MSI 24576-edge      PCIe PME, pciehp
 43:          0  IR-PCI-MSI 116736-edge      PCIe PME
 44:          0  IR-PCI-MSI 118784-edge      PCIe PME
 46:          0  IR-PCI-MSI 13637632-edge      PCIe PME
 47:          0  IR-PCI-MSI 13682688-edge      PCIe PME
 49:          0  IR-PCI-MSI 13748224-edge      PCIe PME
 51:          1  IR-PCI-MSI 14680064-edge      pciehp
 52:          1  IR-PCI-MSI 14696448-edge      pciehp
 54:          1  IR-PCI-MSI 14712832-edge      pciehp
 55:          6  IR-PCI-MSI 14729216-edge      pciehp
 56:          6  IR-PCI-MSI 14745600-edge      pciehp
 57:          6  IR-PCI-MSI 14761984-edge      pciehp
 58:          6  IR-PCI-MSI 14778368-edge      pciehp
 59:          6  IR-PCI-MSI 14794752-edge      pciehp
 60:          6  IR-PCI-MSI 14811136-edge      pciehp
 61:          6  IR-PCI-MSI 14827520-edge      pciehp
 62:          6  IR-PCI-MSI 14843904-edge      pciehp
 63:          6  IR-PCI-MSI 14860288-edge      pciehp
 64:          6  IR-PCI-MSI 14876672-edge      pciehp
 65:          6  IR-PCI-MSI 14893056-edge      pciehp
 66:          6  IR-PCI-MSI 14909440-edge      pciehp
 67:          1  IR-PCI-MSI 14925824-edge      pciehp
 68:          1  IR-PCI-MSI 14942208-edge      pciehp
 69:          6  IR-PCI-MSI 14958592-edge      pciehp
 70:          6  IR-PCI-MSI 14974976-edge      pciehp
 71:          6  IR-PCI-MSI 14991360-edge      pciehp
 72:          6  IR-PCI-MSI 15007744-edge      pciehp
 73:          6  IR-PCI-MSI 15024128-edge      pciehp
 74:          6  IR-PCI-MSI 15040512-edge      pciehp
 75:          6  IR-PCI-MSI 15056896-edge      pciehp
 76:          6  IR-PCI-MSI 15073280-edge      pciehp
 77:          6  IR-PCI-MSI 15089664-edge      pciehp
 78:          6  IR-PCI-MSI 15106048-edge      pciehp
 79:          6  IR-PCI-MSI 15122432-edge      pciehp
 80:          6  IR-PCI-MSI 15138816-edge      pciehp
 81:          6  IR-PCI-MSI 15155200-edge      pciehp
 82:          6  IR-PCI-MSI 15171584-edge      pciehp
 83:          6  IR-PCI-MSI 15187968-edge      pciehp
 84:          6  IR-PCI-MSI 26738688-edge      pciehp
 85:          6  IR-PCI-MSI 26755072-edge      pciehp
 86:          6  IR-PCI-MSI 26771456-edge      pciehp
 87:          6  IR-PCI-MSI 26787840-edge      pciehp
 88:          6  IR-PCI-MSI 26804224-edge      pciehp
 89:          6  IR-PCI-MSI 26820608-edge      pciehp
 90:          6  IR-PCI-MSI 26836992-edge      pciehp
 91:          6  IR-PCI-MSI 26853376-edge      pciehp
 92:          6  IR-PCI-MSI 26869760-edge      pciehp
 93:          6  IR-PCI-MSI 26886144-edge      pciehp
 94:          6  IR-PCI-MSI 26902528-edge      pciehp
 95:          6  IR-PCI-MSI 26918912-edge      pciehp
 96:          6  IR-PCI-MSI 26935296-edge      pciehp
 97:          6  IR-PCI-MSI 26951680-edge      pciehp
 98:          6  IR-PCI-MSI 26968064-edge      pciehp
 99:          6  IR-PCI-MSI 26984448-edge      pciehp
100:          6  IR-PCI-MSI 27000832-edge      pciehp
101:          6  IR-PCI-MSI 27017216-edge      pciehp
102:          6  IR-PCI-MSI 27033600-edge      pciehp
103:          6  IR-PCI-MSI 27049984-edge      pciehp
104:          6  IR-PCI-MSI 27066368-edge      pciehp
105:          6  IR-PCI-MSI 27082752-edge      pciehp
106:          6  IR-PCI-MSI 27099136-edge      pciehp
107:          6  IR-PCI-MSI 27115520-edge      pciehp
108:          6  IR-PCI-MSI 27131904-edge      pciehp
109:          6  IR-PCI-MSI 27148288-edge      pciehp
110:          6  IR-PCI-MSI 27164672-edge      pciehp
111:          6  IR-PCI-MSI 27181056-edge      pciehp
112:          6  IR-PCI-MSI 27197440-edge      pciehp
113:          6  IR-PCI-MSI 27213824-edge      pciehp
114:          6  IR-PCI-MSI 27230208-edge      pciehp
116:          0  IR-PCI-MSI 62396416-edge      PCIe PME
117:          0  IR-PCI-MSI 62441472-edge      PCIe PME, pciehp
118:          0  IR-PCI-MSI 62443520-edge      PCIe PME, pciehp
119:          0  IR-PCI-MSI 62445568-edge      PCIe PME, pciehp
120:          0  IR-PCI-MSI 62447616-edge      PCIe PME, pciehp
122:          0  IR-PCI-MSI 62507008-edge      PCIe PME
124:          0  IR-PCI-MSI 74979328-edge      PCIe PME
125:          0  IR-PCI-MSI 75059200-edge      PCIe PME
126:          0  IR-PCI-MSI 75089920-edge      PCIe PME
127:          0  IR-PCI-MSI 75091968-edge      PCIe PME
129:          0  IR-PCI-MSI 87037952-edge      PCIe PME
130:          0  IR-PCI-MSI 87050240-edge      PCIe PME, pciehp
131:          0  IR-PCI-MSI 87052288-edge      PCIe PME, pciehp
132:          0  IR-PCI-MSI 87054336-edge      PCIe PME, pciehp
133:          0  IR-PCI-MSI 87056384-edge      PCIe PME, pciehp
134:          0  IR-PCI-MSI 87148544-edge      PCIe PME
135:          0  IR-PCI-MSI 87150592-edge      PCIe PME
137:          0  IR-PCI-MSI 100145152-edge      PCIe PME
138:          0  IR-PCI-MSI 100194304-edge      PCIe PME, pciehp
139:          0  IR-PCI-MSI 100196352-edge      PCIe PME, pciehp
141:          0  IR-PCI-MSI 100255744-edge      PCIe PME
143:          0  IR-PCI-MSI 111679488-edge      PCIe PME
145:          0  IR-PCI-MSI 111790080-edge      PCIe PME
147:          0  IR-PCI-MSI 122165248-edge      PCIe PME
148:          0  IR-PCI-MSI 122179584-edge      PCIe PME, pciehp
149:          0  IR-PCI-MSI 122181632-edge      PCIe PME, pciehp
150:          0  IR-PCI-MSI 122275840-edge      PCIe PME
151:          0  IR-PCI-MSI 122277888-edge      PCIe PME
153:          8  IR-PCI-MSI 524288-edge      nvme0q0
155:          0  IR-PCI-MSI 3145728-edge      ahci0
156:          0  IR-PCI-MSI 3145729-edge      ahci1
157:          0  IR-PCI-MSI 3145730-edge      ahci2
158:          0  IR-PCI-MSI 3145731-edge      ahci3
159:          0  IR-PCI-MSI 3145732-edge      ahci4
160:          0  IR-PCI-MSI 3145733-edge      ahci5
161:          0  IR-PCI-MSI 3145734-edge      ahci6
162:          0  IR-PCI-MSI 3145735-edge      ahci7
172:          8  IR-PCI-MSI 87556096-edge      nvme1q0
173:       3165  IR-PCI-MSI 524289-edge      nvme0q1
174:       3165  IR-PCI-MSI 87556097-edge      nvme1q1
176:          0  IR-PCI-MSI 3147776-edge      ahci0
177:          0  IR-PCI-MSI 3147777-edge      ahci1
178:          0  IR-PCI-MSI 3147778-edge      ahci2
179:          0  IR-PCI-MSI 3147779-edge      ahci3
180:          0  IR-PCI-MSI 3147780-edge      ahci4
181:          0  IR-PCI-MSI 3147781-edge      ahci5
182:          0  IR-PCI-MSI 3147782-edge      ahci6
183:          0  IR-PCI-MSI 3147783-edge      ahci7
193:       1549  IR-PCI-MSI 77070336-edge      ahci0
195:          0  IR-PCI-MSI 77070338-edge      ahci2
196:          0  IR-PCI-MSI 77070339-edge      ahci3
197:          0  IR-PCI-MSI 77070340-edge      ahci4
198:          0  IR-PCI-MSI 77070341-edge      ahci5
199:          0  IR-PCI-MSI 77070342-edge      ahci6
200:          0  IR-PCI-MSI 77070343-edge      ahci7
210:          0  IR-PCI-MSI 77072384-edge      ahci0
211:          0  IR-PCI-MSI 77072385-edge      ahci1
212:          0  IR-PCI-MSI 77072386-edge      ahci2
213:          0  IR-PCI-MSI 77072387-edge      ahci3
214:          0  IR-PCI-MSI 77072388-edge      ahci4
215:          0  IR-PCI-MSI 77072389-edge      ahci5
216:          0  IR-PCI-MSI 77072390-edge      ahci6
217:          0  IR-PCI-MSI 77072391-edge      ahci7
227:          0  IR-PCI-MSI 90177536-edge      ahci0
228:          0  IR-PCI-MSI 90177537-edge      ahci1
229:          0  IR-PCI-MSI 90177538-edge      ahci2
230:          0  IR-PCI-MSI 90177539-edge      ahci3
231:          0  IR-PCI-MSI 90177540-edge      ahci4
232:          0  IR-PCI-MSI 90177541-edge      ahci5
233:          0  IR-PCI-MSI 90177542-edge      ahci6
234:          0  IR-PCI-MSI 90177543-edge      ahci7
244:          0  IR-PCI-MSI 90179584-edge      ahci[0000:ac:00.1]
246:          0  IR-PCI-MSI 124256256-edge      ahci[0000:ed:00.0]
248:          0  IR-PCI-MSI 124258304-edge      ahci[0000:ed:00.1]
250:          0  IR-PCI-MSI 2629632-edge      xhci_hcd
NMI:          2   Non-maskable interrupts
LOC:      87976   Local timer interrupts
SPU:          0   Spurious interrupts
PMI:          2   Performance monitoring interrupts
IWI:          0   IRQ work interrupts
RTR:          0   APIC ICR read retries
RES:          0   Rescheduling interrupts
CAL:          0   Function call interrupts
TLB:          0   TLB shootdowns
TRM:          0   Thermal event interrupts
THR:          0   Threshold APIC interrupts
DFR:          0   Deferred Error APIC interrupts
MCE:          0   Machine check exceptions
MCP:          0   Machine check polls
ERR:          0
MIS:          0
PIN:          0   Posted-interrupt notification event
NPI:          0   Nested posted-interrupt event
PIW:          0   Posted-interrupt wakeup event
</code></pre>
<pre><code class="language-c">vector_matrix = irq_alloc_matrix(NR_VECTORS, FIRST_EXTERNAL_VECTOR,
                     FIRST_SYSTEM_VECTOR);
                     
irq_alloc_matrixè®¾ç½®m-&gt;alloc_endä¸ºFIRST_SYSTEM_VECTOR
  
    
å¯ä»¥çœ‹åˆ°åœ¨irq_matrix_allocçš„æ¯”è¾ƒé‡Œï¼Œæ˜¯æ¯”è¾ƒçš„bitå’Œm-&gt;alloc_end
  
  
#ifdef CONFIG_X86_LOCAL_APIC
#define FIRST_SYSTEM_VECTOR        LOCAL_TIMER_VECTOR
#else
#define FIRST_SYSTEM_VECTOR        NR_VECTORS
#endif

æˆ‘ä»¬é…ç½®äº†CONFIG_X86_LOCAL_APICï¼Œæ‰€ä»¥
#define LOCAL_TIMER_VECTOR        0xec


ä¹Ÿå°±æ˜¯m-&gt;alloc_endæ˜¯0xecï¼Œå³236ï¼Ÿ
</code></pre>
<p>æ‰€ä»¥ï¼Œè¿™é‡Œå°±å¯ä»¥å¾—å‡ºç»“è®ºï¼š<font color="red">virtio blkè®¾å¤‡ç”³è¯·ä¸­æ–­ï¼Œåˆ†é…å¤±è´¥ï¼Œè¿”å›äº†ENOSPCï¼Œå¯¼è‡´ç³»ç»Ÿç›˜æ²¡æœ‰æˆåŠŸæŒ‚ä¸Šï¼Œå¯¼è‡´å°å†…æ ¸å¯åŠ¨å¤±è´¥ã€‚è€Œä¸­æ–­å‘é‡ä¸è¶³çš„æ ¹å› å°±æ˜¯ï¼škdumpå°å†…æ ¸çš„cmdlineä¸­é…ç½®äº†nr_cpus&#x3D;1å³ä½¿ç”¨ä¸€ä¸ªcpuå¯åŠ¨ï¼Œæ‰€ä»¥æ‰€æœ‰è®¾å¤‡ä¸­æ–­å…¨éƒ½åˆ†é…åˆ°è¿™ä¸€ä¸ªcpuä¸Šï¼Œå¯¼è‡´æœ¬cpuçš„ä¸­æ–­å‘é‡ä¸è¶³å¤Ÿåˆ†é…äº†</font></p>
<p>æ‰€ä»¥è§£å†³æ–¹æ³•ä¹Ÿç®€å•ï¼Œå¤šä½¿ç”¨å‡ ä¸ªcpuå¯åŠ¨å°å†…æ ¸å°±å¥½äº†</p>
<h3 id="åç»­"><a href="#åç»­" class="headerlink" title="åç»­"></a><center>åç»­</center></h3><p>ä¸€ä¸ªæœ‰ç”¨çš„ç½‘ç«™ï¼š<a target="_blank" rel="noopener" href="https://fedoraproject.org/wiki/How_to_debug_Dracut_problems">https://fedoraproject.org/wiki/How_to_debug_Dracut_problems</a></p>
<p>ä»‹ç»äº†ä¸€äº›debug dracutçš„æ–¹æ³•ï¼Œçœ‹ä¸Šå»æ¯”è¾ƒæœ‰ç”¨çš„æœ‰è¿™å‡ ç§:</p>
<pre><code class="language-c">##æŠŠè¿™ä¸ªæ·»åŠ åˆ°cmdlineï¼Œå¦‚æœæ‰¾ä¸åˆ°æ ¹ï¼Œä¼šæ˜¾ç¤ºshell
rd.shell		

##è¿™ä¸ªæ˜¯çœŸæ»´å¼ºï¼Œæ„Ÿè°¢è¿™ä¸ªï¼Œè®©æˆ‘å®šä½äº†ä¸Šé¢çš„é—®é¢˜
##æŠŠè¿™ä¸ªåŠ åˆ°cmdlineä¸­ï¼Œå¯ä»¥åœ¨æŒ‡å®šçš„é˜¶æ®µæ–­ç‚¹ï¼Œè¿›å…¥emergency shellä¸­ï¼Œè¿›è¡Œè°ƒè¯•
##å¯ä»¥ä½¿ç”¨egrep &#39;rd.?break&#39; /usr/lib/dracut/modules.d/99base/init.shæ¥ç¡®å®šæ”¯æŒçš„æ–­ç‚¹
rd.break=[cmdline|pre-udev|pre-trigger|initqueue|pre-mount|mount|pre-pivot|cleanup]
</code></pre>
<p>å¦å¤–ï¼Œå¯¹äºkdumpçš„è°ƒè¯•ï¼Œæ¯”å¦‚ï¼Œè¿›å…¥æ–­ç‚¹çš„shellä¸­åªèƒ½ä½¿ç”¨ä¸€äº›åŸºç¡€å‘½ä»¤ï¼Œå¦‚æœæƒ³ä½¿ç”¨ä¸€äº›é«˜çº§å‘½ä»¤è¯¥æ€ä¹ˆåšå‘¢ï¼Ÿè¿™ä¸ªå¯ä»¥çœ‹ä¸€ä¸‹&#x2F;etc&#x2F;kdump.confä¸­çš„extra_binsï¼Œè¿™ä¸ªçœ‹ä¸Šå»æ˜¯å¯ä»¥æŠŠä¸€äº›binaryæ‰“åŒ…åˆ°kdump.imgä¸­ï¼Œçœ‹ä¸Šå»æŒºå®ç”¨çš„ï¼Œè™½ç„¶æˆ‘å°è¯•ä¼ å…¥lspciå¤±è´¥äº†</p>

      
       <hr><span style="font-style: italic;color: gray;"> è½¬è½½è¯·æ³¨æ˜æ¥æºï¼Œæ¬¢è¿å¯¹æ–‡ç« ä¸­çš„å¼•ç”¨æ¥æºè¿›è¡Œè€ƒè¯ï¼Œæ¬¢è¿æŒ‡å‡ºä»»ä½•æœ‰é”™è¯¯æˆ–ä¸å¤Ÿæ¸…æ™°çš„è¡¨è¾¾ã€‚å¯ä»¥åœ¨ä¸‹é¢è¯„è®ºåŒºè¯„è®ºï¼Œä¹Ÿå¯ä»¥é‚®ä»¶è‡³ 857879363@qq.com </span>
    </div>
</article>





    <div id="comments"></div>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css">

<script type="text/javascript">
    $.getScript('/js/gitalk.js', function () {
        var gitalk = new Gitalk({
            clientID: 'Ov23lihTjDF3jklWOX9b',
            clientSecret: '1304f65e90138886cd32255710839a4ba192f266',
            repo: 'yzwddsg-plus.github.io',
            owner: 'yzwddsg-plus',
            admin: ['yzwddsg-plus'],
            id: decodeURI(location.pathname),
            distractionFreeMode: 'true',
            language: 'zh-CN',
            perPage: parseInt('10',10)
        })
        gitalk.render('comments')
    })
</script>







    </div>
    <div class="copyright">
        <p class="footer-entry">
    YZWDDSG
</p>
<p class="footer-entry">Built with <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/yelog/hexo-theme-3-hexo" target="_blank">3-hexo</a> theme</p>

    </div>
    <div class="full-toc">
        <button class="full" data-title="åˆ‡æ¢å…¨å± å¿«æ·é”® s"><span class="min "></span></button>
<a class="" id="rocket" ></a>

    </div>
</div>

</body>
<script src="/js/jquery.pjax.js?v=1.1.0" ></script>

<script src="/js/script.js?v=1.1.0" ></script>
<script>
    var img_resize = 'default';
    function initArticle() {
        /*æ¸²æŸ“å¯¹åº”çš„è¡¨æ ¼æ ·å¼*/
        

        /*æ¸²æŸ“æ‰“èµæ ·å¼*/
        

        /*é«˜äº®ä»£ç å—è¡Œå·*/
        

        /*è®¿é—®æ•°é‡*/
        

        /*ä»£ç é«˜äº®ï¼Œè¡Œå·å¯¹é½*/
        $('.pre-numbering').css('line-height',$('.has-numbering').css('line-height'));

        
        
    }

    /*æ‰“èµé¡µé¢éšè—ä¸å±•ç¤º*/
    

</script>

<!--åŠ å…¥è¡Œå·çš„é«˜äº®ä»£ç å—æ ·å¼-->

<!--è‡ªå®šä¹‰æ ·å¼è®¾ç½®-->
<style>
    
    
    .nav-right .title-list nav a .post-title, .nav-right .title-list #local-search-result a .post-title {
        color: #383636;
    }
    
    
    .nav-right .title-list nav a .post-date, .nav-right .title-list #local-search-result a .post-date {
        color: #5e5e5f;
    }
    
    
    .nav-right nav a.hover, #local-search-result a.hover{
        background-color: #e2e0e0;
    }
    
    

    /*åˆ—è¡¨æ ·å¼*/
    

    /* èƒŒæ™¯å›¾æ ·å¼ */
    
    


    /*å¼•ç”¨å—æ ·å¼*/
    

    /*æ–‡ç« åˆ—è¡¨èƒŒæ™¯å›¾*/
    
    .nav-right:before {
        content: ' ';
        display: block;
        position: absolute;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        opacity: 0.3;
        background: url("https://i.loli.net/2019/07/22/5d3521411f3f169375.png");
        background-repeat: no-repeat;
        background-position: 50% 0;
        -ms-background-size: cover;
        -o-background-size: cover;
        -moz-background-size: cover;
        -webkit-background-size: cover;
        background-size: cover;
    }
    

    
    #post .pjax article :not(pre) > code {
        color: #24292e;
        font-family: SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;
        background-color: rgba(27,31,35,.05);
        border-radius: 3px;
        font-size: 85%;
        margin: 0;
        padding: .2em .4em;
    }
    
</style>







</html>
